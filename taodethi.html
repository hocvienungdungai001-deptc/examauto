<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªá Th·ªëng T·∫°o ƒê·ªÅ Thi T·ª± ƒê·ªông VDC</title>
    <style>
        /* --- CSS GIAO DI·ªÜN CHU·∫®N (KH√îNG CH·ªàNH S·ª¨A) --- */
        body { font-family: 'Times New Roman', serif; margin: 0; padding: 0; background: #eee; }
        
        /* C·∫•u h√¨nh trang gi·∫•y A4 */
        .page { 
            width: 210mm; min-height: 297mm; 
            background: white; margin: 20px auto; 
            padding: 15mm 10mm; 
            position: relative; 
            box-sizing: border-box; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1); 
            page-break-after: always; /* Ng·∫Øt trang khi in */
        }

        /* 4 Marker ƒë·ªãnh v·ªã cho Python */
        .marker { width: 15px; height: 15px; background: black; position: absolute; }
        .tl { top: 10mm; left: 10mm; }
        .tr { top: 10mm; right: 10mm; }
        .bl { bottom: 10mm; left: 10mm; }
        .br { bottom: 10mm; right: 10mm; }

        /* Header & Info */
        .header { display: flex; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
        .logo { width: 100px; text-align: center; font-weight: bold; display: flex; align-items: center; justify-content: center; border: 1px dashed #ccc; margin-right: 15px; }
        .company-info { flex: 1; }
        .company-info h3 { margin: 0; font-size: 14px; text-transform: uppercase; }
        .company-info p { margin: 2px 0; font-size: 11px; }
        .test-title { text-align: center; margin-top: 10px; }
        .test-title h1 { margin: 0; font-size: 18px; text-transform: uppercase; }
        .test-title h2 { margin: 5px 0; font-size: 14px; font-weight: normal; }

        .info-box { border: 1px solid #333; padding: 10px; margin-bottom: 20px; font-size: 13px; }
        .info-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .info-item { flex: 1; }
        
        /* √î M√£ s·ªë Trang 1 */
        .id-area { display: flex; align-items: center; margin-top: 5px; }
        .id-grid { display: flex; gap: 5px; margin-left: 10px; }
        .id-box { width: 20px; height: 20px; border: 1px solid #000; text-align: center; line-height: 20px; color: #ccc; font-size: 10px; }

        /* C√¢u h·ªèi & ƒê√°p √°n */
        .question-block { margin-bottom: 15px; }
        .q-text { font-weight: bold; font-size: 14px; margin-bottom: 5px; text-align: justify; }
        .options { margin-left: 15px; font-size: 13px; margin-bottom: 8px; }
        .opt-row { display: flex; justify-content: space-between; }
        .opt { width: 48%; margin-bottom: 3px; }
        
        /* D·∫£i ch·∫•m t·ª± ƒë·ªông (Hybrid Strip) */
        .answer-strip { background: #f0f0f0; border: 1px solid #999; padding: 5px 10px; display: flex; align-items: center; width: 100%; box-sizing: border-box; }
        .strip-label { font-size: 11px; font-weight: bold; margin-right: 15px; text-transform: uppercase; }
        .checkbox-group { display: flex; gap: 20px; }
        .cb-item { display: flex; align-items: center; cursor: pointer; }
        .box { width: 16px; height: 16px; border: 2px solid #000; background: white; margin-right: 5px; display: inline-block; }
        .cb-label { font-weight: bold; font-size: 14px; }

        /* KHUNG NH·∫¨P LI·ªÜU (·∫®n khi in) */
        .control-panel {
            position: fixed; left: 20px; top: 20px; bottom: 20px; width: 320px;
            background: #fff; padding: 20px; box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            overflow-y: auto; z-index: 1000;
        }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px; }
        .input-group input, .input-group textarea { width: 100%; padding: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        .btn { width: 100%; padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn:hover { background: #0056b3; }
        .btn-print { background: #dc3545; }

        /* V√πng hi·ªÉn th·ªã ƒë·ªÅ thi (B√™n ph·∫£i) */
        #preview-area { margin-left: 360px; padding-top: 1px; padding-bottom: 50px; }

        /* CSS IN ·∫§N */
        @media print {
            body { background: white; }
            .control-panel { display: none !important; }
            #preview-area { margin: 0; padding: 0; }
            .page { margin: 0; border: none; box-shadow: none; width: 100%; }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

    <div class="control-panel">
        <h3 style="margin-top:0; text-align: center;">‚öôÔ∏è C·∫§U H√åNH ƒê·ªÄ THI</h3>
        
        <div class="input-group">
            <label>T√™n B√†i Thi:</label>
            <input type="text" id="inpExamName" value="B√ÄI KI·ªÇM TRA S√ÅT H·∫†CH NH√ìM 3">
        </div>
        <div class="input-group">
            <label>Th·ªùi gian (ph√∫t):</label>
            <input type="number" id="inpTime" value="60">
        </div>
        
        <div class="input-group">
            <label>S·ªë c√¢u m·ªói trang (ƒë·ªÉ ng·∫Øt trang):</label>
            <input type="number" id="inpLimitPage1" value="6" placeholder="Trang 1">
            <input type="number" id="inpLimitPage2" value="8" placeholder="Trang 2 tr·ªü ƒëi" style="margin-top:5px;">
        </div>

        <div class="input-group">
            <label>N·ªôi dung c√¢u h·ªèi (Copy t·ª´ Word):</label>
            <textarea id="inpContent" rows="15" placeholder="C√¢u 1: ...
A. ...
B. ..."></textarea>
        </div>

        <button class="btn" onclick="generateExam()">üîÑ T·∫†O ƒê·ªÄ THI</button>
        <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è XU·∫§T PDF</button>
    </div>

    <div id="preview-area"></div>

    <script>
        // D·ªØ li·ªáu m·∫´u ƒë·ªÉ test
        const sampleData = `C√¢u 1: Bi·ªÉn b√°o an to√†n ƒëi·ªán c√≥ h√¨nh d·∫°ng g√¨?
A. H√¨nh tr√≤n
B. H√¨nh tam gi√°c
C. H√¨nh vu√¥ng
D. H√¨nh ch·ªØ nh·∫≠t

C√¢u 2: ƒêi·ªán √°p an to√†n l√† bao nhi√™u?
A. D∆∞·ªõi 40V
B. D∆∞·ªõi 50V
C. Tr√™n 100V
D. 220V

C√¢u 3: Khi th·∫•y ng∆∞·ªùi b·ªã ƒëi·ªán gi·∫≠t c·∫ßn l√†m g√¨?
A. Ng·∫Øt ƒëi·ªán
B. H√¥ ho√°n
C. S∆° c·ª©u
D. T·∫•t c·∫£ √Ω tr√™n

C√¢u 4: Thi·∫øt b·ªã n√†o d√πng ƒë·ªÉ ƒë√≥ng c·∫Øt ƒëi·ªán?
A. C·∫ßu dao
B. Aptomat
C. C√¥ng t·∫Øc
D. C·∫£ 3 ƒë√∫ng

C√¢u 5: M√†u s·∫Øc d√¢y n·ªëi ƒë·∫•t an to√†n l√† g√¨?
A. V√†ng xanh
B. ƒê·ªè
C. ƒêen
D. Tr·∫Øng

C√¢u 6: PPE l√† vi·∫øt t·∫Øt c·ªßa?
A. Thi·∫øt b·ªã b·∫£o v·ªá c√° nh√¢n
B. Quy tr√¨nh an to√†n
C. M√°y m√≥c
D. Kh√¥ng c√≥ √Ω nghƒ©a

C√¢u 7: Chi·ªÅu cao l√†m vi·ªác tr√™n cao t√≠nh t·ª´?
A. 2m
B. 3m
C. 1.5m
D. 1m`;

        document.getElementById('inpContent').value = sampleData;

        function generateExam() {
            const examName = document.getElementById('inpExamName').value;
            const content = document.getElementById('inpContent').value;
            const limitP1 = parseInt(document.getElementById('inpLimitPage1').value) || 6;
            const limitP2 = parseInt(document.getElementById('inpLimitPage2').value) || 8;

            const previewArea = document.getElementById('preview-area');
            previewArea.innerHTML = ''; // X√≥a tr·∫Øng c≈©

            // 1. Ph√¢n t√≠ch n·ªôi dung c√¢u h·ªèi (Parsing)
            const questions = parseQuestions(content);
            if (questions.length === 0) {
                alert("Kh√¥ng t√¨m th·∫•y c√¢u h·ªèi n√†o! Vui l√≤ng nh·∫≠p ƒë√∫ng ƒë·ªãnh d·∫°ng 'C√¢u 1:' ho·∫∑c '1.'");
                return;
            }

            // 2. Thu·∫≠t to√°n ph√¢n trang
            let currentPageIndex = 1;
            let currentQuestionCount = 0;
            let pageContainer = createPage(1, examName); // T·∫°o trang 1
            let questionsContainer = pageContainer.querySelector('.questions-container');

            questions.forEach((q, index) => {
                // Ki·ªÉm tra gi·ªõi h·∫°n trang
                const limit = (currentPageIndex === 1) ? limitP1 : limitP2;

                if (currentQuestionCount >= limit) {
                    // ƒê√£ ƒë·∫ßy trang -> ƒê·∫©y trang c≈© v√†o DOM
                    previewArea.appendChild(pageContainer);
                    
                    // T·∫°o trang m·ªõi
                    currentPageIndex++;
                    currentQuestionCount = 0;
                    pageContainer = createPage(currentPageIndex, examName);
                    questionsContainer = pageContainer.querySelector('.questions-container');
                }

                // Render c√¢u h·ªèi v√†o trang hi·ªán t·∫°i
                const qElement = renderQuestionHTML(q);
                questionsContainer.appendChild(qElement);
                currentQuestionCount++;
            });

            // ƒê·∫©y trang cu·ªëi c√πng v√†o DOM
            previewArea.appendChild(pageContainer);
        }

        // H√†m t·∫°o khung trang gi·∫•y (Header + Markers)
        function createPage(pageIndex, examName) {
            const div = document.createElement('div');
            div.className = 'page';
            
            // Marker
            div.innerHTML = `
                <div class="marker tl"></div><div class="marker tr"></div>
                <div class="marker bl"></div><div class="marker br"></div>
            `;

            if (pageIndex === 1) {
                // --- TRANG 1: HEADER ƒê·∫¶Y ƒê·ª¶ ---
                div.innerHTML += `
                    <div class="header">
                        <div class="logo">LOGO VDC</div>
                        <div class="company-info">
                            <h3>C√îNG TY C·ªî PH·∫¶N H·ª¢P T√ÅC QU·ªêC T·∫æ VDC</h3>
                            <p>ƒêC: S·ªë nh√† 46 LK11 Khu ƒë√¥ th·ªã m·ªõi ƒê√¥ng S∆°n, P. An H∆∞ng, TP. Thanh Ho√°</p>
                            <div class="test-title">
                                <h1>${examName.toUpperCase()}</h1>
                                <h2>KH√ìA HU·∫§N LUY·ªÜN AN TO√ÄN, V·ªÜ SINH LAO ƒê·ªòNG NH√ìM 3</h2>
                            </div>
                        </div>
                    </div>
                    <div class="info-box">
                        <div class="info-row">
                            <div class="info-item">H·ªç t√™n: ............................................................</div>
                            <div class="info-item">Ng√†y sinh: .......................................</div>
                        </div>
                        <div class="info-row">
                            <div class="info-item">ƒê∆°n v·ªã: ..............................................................</div>
                            <div class="info-item">Ch·ªØ k√Ω: ...........................................</div>
                        </div>
                        <div class="info-row" style="margin-top:5px; border-top:1px dotted #999; padding-top:5px;">
                             <div class="info-item" style="display:flex; align-items:center;">
                                <span style="font-weight:bold; margin-right:10px;">M√É S·ªê HV:</span>
                                <div class="id-grid">
                                    <div class="id-box"></div><div class="id-box"></div><div class="id-box"></div>
                                </div>
                             </div>
                             <div class="info-item" style="font-style:italic; font-size:11px; text-align:right;">
                                * T√¥ k√≠n √¥ vu√¥ng ƒë√°p √°n ƒë√∫ng.
                             </div>
                        </div>
                    </div>
                `;
            } else {
                // --- TRANG 2+: MINI ID STRIP (QUAN TR·ªåNG) ---
                div.innerHTML += `
                    <div style="border-bottom: 1px dashed #999; padding-bottom: 10px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between;">
                        <div style="font-size: 11px; font-weight: bold; text-transform: uppercase;">
                            Ti·∫øp theo trang ${pageIndex - 1} - ${examName.toUpperCase()}
                        </div>
                        <div style="display:flex; align-items:center;">
                            <span style="font-size: 11px; font-weight: bold; margin-right: 10px;">M√É S·ªê (Ghi l·∫°i):</span>
                            <div class="id-grid" style="display:flex; gap:5px;">
                                <div class="id-box"></div><div class="id-box"></div><div class="id-box"></div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Container ch·ª©a c√¢u h·ªèi
            const qContainer = document.createElement('div');
            qContainer.className = 'questions-container';
            div.appendChild(qContainer);

            return div;
        }

        // H√†m parse text c√¢u h·ªèi
        function parseQuestions(text) {
            const lines = text.split('\n');
            const questions = [];
            let currentQ = null;

            lines.forEach(line => {
                line = line.trim();
                if (!line) return;

                // Regex b·∫Øt "C√¢u 1:", "B√†i 1:", "1."
                if (line.match(/^(C√¢u|B√†i|\d+\.)/i)) {
                    if (currentQ) questions.push(currentQ);
                    currentQ = { text: line, options: [] };
                } else if (currentQ) {
                    // L√† ƒë√°p √°n (A. B. C. D.)
                    currentQ.options.push(line);
                }
            });
            if (currentQ) questions.push(currentQ);
            return questions;
        }

        // H√†m render HTML cho 1 c√¢u h·ªèi
        function renderQuestionHTML(q) {
            const div = document.createElement('div');
            div.className = 'question-block';

            // T·∫°o n·ªôi dung c√¢u h·ªèi
            let html = `<div class="q-text">${q.text}</div>`;
            
            // T·∫°o options
            html += `<div class="options">`;
            // Gom 2 ƒë√°p √°n 1 d√≤ng cho g·ªçn
            for (let i = 0; i < q.options.length; i += 2) {
                html += `<div class="opt-row">`;
                html += `<div class="opt">${q.options[i] || ''}</div>`;
                if (q.options[i+1]) html += `<div class="opt">${q.options[i+1]}</div>`;
                html += `</div>`;
            }
            html += `</div>`;

            // T·∫°o d·∫£i ch·∫•m (Hybrid Strip)
            html += `
                <div class="answer-strip">
                    <span class="strip-label">Tr·∫£ l·ªùi:</span>
                    <div class="checkbox-group">
                        <div class="cb-item"><span class="box"></span><span class="cb-label">A</span></div>
                        <div class="cb-item"><span class="box"></span><span class="cb-label">B</span></div>
                        <div class="cb-item"><span class="box"></span><span class="cb-label">C</span></div>
                        <div class="cb-item"><span class="box"></span><span class="cb-label">D</span></div>
                    </div>
                </div>
            `;
            
            div.innerHTML = html;
            return div;
        }

        // Ch·∫°y l·∫ßn ƒë·∫ßu
        generateExam();
    </script>
</body>
</html>
